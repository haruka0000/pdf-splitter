<html>
<head>
    <meta charset="UTF-8">
    <title>Eel</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>
    <button id="pdf_path" name="pdf_path" onclick="getFolder()">Import PDF</button>
    <!--テーブル生成位置-->
    <div>
        <table id='maintable'>
            <!-- <thead></thead><tbody></tbody> -->
        </table>
    </div>

    <!-- Python用 -->
    <script type="text/javascript" src="/eel.js"></script>
    
    <script type="text/javascript">
        var pdf_path = "";
        var table = document.getElementById('maintable');
        async function run() {
            table.innerHTML = ''
            var thead = document.createElement('thead');
            var tbody = document.createElement('tbody');
            table.appendChild(thead);
            table.appendChild(tbody);
            let data = await eel.get_table_data(pdf_path)();
            // tr部分のループ
            for (var i = 0; i < data.length; i++) {
                // tr要素を生成
                var tr = document.createElement('tr');

                // th・td部分のループ
                for (var j = 0; j < data[i].length; j++) {
                    // 1行目のtr要素の時
                    if(i === 0) {
                        var th = document.createElement('th');
                        th.textContent = data[i][j];
                        tr.appendChild(th)
                    } else{
                        var td = document.createElement('td');
                        var cell = document.createElement('input');
                        cell.classList.add('cellinputs');
                        cell.value = data[i][j];
                        td.appendChild(cell)
                        tr.appendChild(td) 
                    }
                }
                // 1行目のtr要素の時
                if(i === 0) {
                    thead.appendChild(tr);
                } else{
                    tbody.appendChild(tr);
                }
            }
        }
        
        // SUBMITされたとき
        async function getFolder() {
            // ファイル入力
            pdf_path = await eel.btn_ResimyoluClick()();
            // 再描画
            run();
        }
    </script>
</body>
</html>
